title: 服务化之“隔靴搔痒“与“刮骨疗伤”
date: 2016-04-22 21:37:13
tags: 服务化
---
服务化该怎么做？你问不同的公司，得到的答案基本上是各不相同。原因无他，因为每个公司的业务形态，技术架构与组织结构都是不同的。而服务化改造的内容需要，也一定会涉及到这三个方面的变动。所以到底是只做“隔靴搔痒”的实施，还是进行“刮骨疗伤”变动？这是个问题。但在说方案前还必须先回答一个问题：什么是服务化？

## 什么是服务化？
当前业界所谈的服务化其实都是指微服务化，Martin Fowler在2014年就提出过这个概念，而被业界广泛采用的是2015年。微服务的架构定义：

>  **微服务架构是一种架构模式**，它提倡**将单一应用程序划分成一组小的服务**，服务之间互相协调、互相配合，为用户提供最终价值。**每个服务运行在其独立的进程中**,服务与服务间采用**轻量级的通信机制**互相沟通(通常是基于HTTP协议的RESTful API)。每个服务都围绕着具体业务进行构建，并且**能够被独立的部署**到生产环境、类生产环境等。另外，应当**尽量避免统一的、集中式**的服务管理机制，对具体的一个服务而言，应根据业务上下文，选择合适的语言、工具对其进行构建。

## 为什么要进行微服务化改造？
> 让系统尽可能快的响应变化

这里的变化即包含技术的变化，也包括业务的变化。从业务角度上来说，只有让服务在对应的业务粒度上足够小，那么随着业务形态的变化可以更从容的响应这种变化。而从技术角度上来说，进行微服务化改造的目的是让服务的职责更内聚。将每个服务所依赖的共有功能抽取出来形成一个统一的平台，这样的平台才可以更好支撑的技术发展。

## 如何实现微服务化？
> 一切美好事物的背后总是有一堆的坑在等着你

微服务化听起来是美好的，更容易的独立部署，更好的自动伸缩，更快的响应业务变化。然而在这些美好的目标背后我们需要做出巨大的改变：

1. 组织结构的改变，任何的产品上架构变化都需要有响应的组织结构变化。微服务的架构需要组织从传统的职能线模式朝特征团队模式改变。微服务必然是由一个小型团队来负责的，但这个团队必须是全功能的，因为微服务强调的是端到端的业务支持能力。因此以传统的职能线模式运行，模块式进行协助的方式是不可行的。


2. 监控能力的提升，没有监控的护航微服务改造必将会陷入到困境中，所谓“勿于浮沙筑高台“就是这个道理。微服务改造带来的直接结果是服务变多，粒度变细。而原来只需要跨越1-2个服务的调用会变成跨越4-5个服务。而这种复杂性带来的问题就是排错难度加大，因此如果没有高效的监控系统准确发现问题，更快的找到问题的根源。业务的压力就可能逼迫微服务改造倒退。而做到这一点，服务自身也需要对监控做出一些支持，如果这时有一个底层的框架那么事情就会简单很多。

说到监控，目前业界的主要做法是通过日志或者数据上报的方式来实现监控。工具上是开源的方案，比如阿里开源的Dubbo系统。开源的工具相对来说对业务的支持可能没那么好，因此还是需要进行开发维护的。